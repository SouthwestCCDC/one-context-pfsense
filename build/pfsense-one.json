{
     "variables": {
       "iso": "pfsense.iso"
     },
     "builders": [
          {
               "http_directory": "http",
               "http_port_min": "8100",

               "type": "virtualbox-iso",
               "headless": false,
               "boot_wait": "50s",
               "boot_command": [
                    "<enter>",
                    "<wait5s>io<enter>",
                    "<wait5s><enter>",
                    "<wait5s><down><enter>",
                    "<wait100s>n",
                    "<wait>r",
                    "<wait90s>",
                    "8<enter><wait3s>",
                    "telnet {{ .HTTPIP }} {{ .HTTPPort }} | sed '1,/^$/d' >/usr/local/sbin/one-context<wait><enter>",
                    "GET /one-context HTTP/1.0<enter><enter>",
                    "<wait>chmod 755 /usr/local/sbin/one-context<enter>",
                    "telnet {{ .HTTPIP }} {{ .HTTPPort }} | sed '1,/^$/d' >one-context-install<wait><enter>",
                    "GET /one-context-install HTTP/1.0<enter><enter>",
                    "chmod 755 one-context-install<enter>",
                    "./one-context-install<enter>",
                    "<wait10s>"
               ],
               "disk_size": 4096,
               "cpus": 2,
               "memory": 2048,
               "guest_additions_mode": "disable",
               "vm_name": "swccdc_pfsense_packer",
               "guest_os_type": "FreeBSD_64",
               "iso_url": "{{ user `iso` }}",
               "iso_checksum": "none",
               "shutdown_command": "8<enter>reboot<enter>",
               "vboxmanage": [
                 ["modifyvm", "{{.Name}}", "--audio", "none"],
                 ["modifyvm", "{{.Name}}", "--mouse", "usbtablet"],
                 ["modifyvm", "{{.Name}}", "--graphicscontroller", "vmsvga"],
                 ["modifyvm", "{{.Name}}", "--vram", "16"],
                 ["modifyvm", "{{.Name}}", "--nic2", "intnet"]
               ],
               "communicator": "none",
               "virtualbox_version_file": "",
               "ssh_username": "root",
               "ssh_password": "swccdc"
          },
          {
               "http_directory": "http",
               "http_port_min": "8100",
               "type": "qemu",
               "headless": "false",
               "boot_wait": "5s",
               "boot_steps": [
                    ["1<enter><wait45s>", "Boot into installer media..."],
                    ["<enter><wait3s>", "Accept installer terms."],
                    ["io<enter><wait5s>", "Select Install."],
                    ["<enter><wait>", "Set keyboard map."],
                    ["<down><enter>", "UFS with UEFI."],
                    ["<wait100s>", "Wait for installer to copy files..."],
                    ["n<wait>", "Don't drop into a root shell."],
                    ["r<wait60s>", "Rebooting..."],
                    ["n<enter><wait>", "No VLANs please."],
                    ["em0<enter><wait>", "Configure em0 as WAN."],
                    ["<enter><wait>", "Skipping LAN."],
                    ["y<enter><wait>", "Write config."],
                    ["<wait60s>", "Wait for config to load..."],
                    ["8<enter><wait3s>", "Drop to a shell."],
                    ["telnet {{ .HTTPIP }} {{ .HTTPPort }} | sed '1,/^$/d' > /usr/local/sbin/one-context<wait><enter>", "HTTP connection for one-context"],
                    ["GET /one-context HTTP/1.0<enter><enter>", "HTTP GET one-context"],
                    ["<wait>chmod 755 /usr/local/sbin/one-context<enter>", "chmod +x one-context"],
                    ["telnet {{ .HTTPIP }} {{ .HTTPPort }} | sed '1,/^$/d' > one-context-install<wait><enter>", "HTTP connection for one-context-install"],
                    ["GET /one-context-install HTTP/1.0<enter><enter>", "HTTP GET one-context-install"],
                    ["chmod 755 one-context-install<enter>", "chmod +x one-context-install"],
                    ["./one-context-install<enter><wait5s>", "Run one-context-install..."],
                    ["shutdown -p now<enter><wait15s>", "Wait..."]
               ],
               "vm_name": "swccdc_pfsense_packer",
               "iso_url": "{{ user `iso` }}",
               "iso_checksum": "none",
               "communicator": "none",
               "format": "qcow2",
               "net_device": "e1000"

          }
     ],
     "provisioners": [
     ]
}
